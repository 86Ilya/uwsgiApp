# UWSGI приложение ip2w
Данное uwsgi приложение является простым сервисом выяснения погоды по ip адресу.

## Установка с использованием Docker контейнера
Для создания необходимого окружения запуска в комплекте имеется `Dockerfile`.
Для сборки контейнера достаточно запустить команду:
```bash
sh ./deploy.sh
```
После окончания сборки будут запущен сервис и тесты, и будет указан эндпоинт данного сервиса.

## Установка и запуск
Для установки пакета в систему достаточно выполнить команду:
```bash
sudo rpm -i ip2w-0.0.1-1.noarch.rpm
```
После установки запустить сервис можно командой:
```bash
sudo systemctl start ip2w.service
```
Конфиг сервиса находится по адресу `/usr/local/etc/ip2w.conf`
После запуска сервис слушает локальный сокет `/tmp/ip2w_uwsgi.sock`, а nginx
проксирует все запросы с 80 порта на этот сокет.

### Примеры запуска сервера
Сервис запускается автоматически после загрузки ОС используя *systemd*.
Если по каким либо причинам вам надо запустить его вручную, то достаточно выполнить команду:
```bash
sudo systemctl start ip2w.service
```
После запуска сервиса его работу можно проверить так:
```bash
curl http://localhost/ip2w/5.18.102.113
{"city": "Saint Petersburg", "conditions": "Clouds", "temp": "1.81"}
```

## Запуск тестов
Для запуска тестов необходимо проверить запущен ли сервис и если нет, то запустить его:
```bash
sudo service ip2w start
```
После этого запустить непосредственно сами тесты
```bash
pytest -v -s tests/
```